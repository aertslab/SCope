name: Client CI
on:
  pull_request:
    paths-ignore:
    - 'server/**'
    - 'grpc-proxy-server/**'
    - 'docs/**'

jobs:
  client-quality-checks:

    runs-on: ubuntu-latest
    env:
      working-directory: ./client

    steps:
      - uses: actions/checkout@v2
      - name: Install dependencies
        uses: actions/setup-node@v1
        with:
          node-version: '16.x'
      - name: Install
        run: |
          npm ci
        working-directory: ${{ env.working-directory }}
      - name: Check for outdated dependencies
        run: |
          npm outdated || exit 0
        working-directory: ${{ env.working-directory }}
      - name: Security audit
        run: |
          npm audit --audit-level=moderate
        working-directory: ${{ env.working-directory }}
      - name: Build production application
        run: |
          npm build
        working-directory: ${{ env.working-directory }}
      - name: Lint
        run: |
          npm run lint
        working-directory: ${{ env.working-directory }}
      - name: Test
        run: |
          npm test
        working-directory: ${{ env.working-directory }}

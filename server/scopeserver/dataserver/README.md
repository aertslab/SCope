# SCope Data Server

## G-Server

The GServer was built using the gRPC python implementation available from pip. The python implementation was chosen because a nice file format (.loom) has been developed to store single-cell dataset in a efficient way.

### Install gRPC (Python implementation)

From https://grpc.io/docs/quickstart/python.html:
```
python -m pip install --upgrade pip
python -m pip install grpcio
python -m pip install grpcio-tools
```

### Define the gRPC service
The gRPC service is defined by means of the protobuf file (.proto).

### Generate the gRPC code

The gRPC code is made of 2 files: `*_pb2_grpc.py` and `*_pb2.py`. Those are generated by compiling the Protobuf interface.
At the root of the project, either run:
```
bash compile_proto.sh
```
or:
```
python -m grpc.tools.protoc  --python_out=opt/scopeserver/dataserver/modules/gserver/ --grpc_python_out=opt/scopeserver/dataserver/modules/gserver/ --proto_path=src/proto/ s.proto
```

Once generated, `s_pb2_grpc.py` should be edited to fix module imports.
```
import s_pb2 as s__pb2
```
should be replaced with
```
from scopeserver.dataserver.modules.gserver import s_pb2 as s__pb2
```
